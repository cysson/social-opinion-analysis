{
  "timestamp": "2025-12-19 18:21:33",
  "cleaning_objective": "提高数据质量，为后续分析（情感分析、聚类、关联规则挖掘、可视化）做准备",
  "cleaning_steps": [
    {
      "step": 1,
      "name": "删除完全空白的行",
      "reason": "空白行无分析价值，占用存储空间"
    },
    {
      "step": 2,
      "name": "数据类型标准化",
      "reason": "确保时间、数值、字符串类型正确，便于后续分析"
    },
    {
      "step": 3,
      "name": "处理缺失值",
      "reason": "关键字段（时间、内容、用户ID）缺失会影响分析准确性"
    },
    {
      "step": 4,
      "name": "文本内容清洗",
      "reason": "移除URL、表情符号等噪音，保留有用文本用于情感分析和聚类"
    },
    {
      "step": 5,
      "name": "去重处理",
      "reason": "重复数据会影响统计分析和算法准确性"
    },
    {
      "step": 6,
      "name": "特征工程",
      "reason": "添加时间特征、地理位置特征、用户活跃度等，支撑后续可视化分析"
    },
    {
      "step": 7,
      "name": "过滤噪音数据",
      "reason": "移除过短、无意义的评论和疑似机器人账号，提高数据质量"
    }
  ],
  "raw_data": {
    "total_records": 30807,
    "columns": [
      "comment_id",
      "create_time",
      "ip_location",
      "note_id",
      "content",
      "user_id",
      "nickname",
      "avatar",
      "sub_comment_count",
      "pictures",
      "parent_comment_id",
      "last_modify_ts",
      "like_count",
      "type",
      "title",
      "desc",
      "video_url",
      "time",
      "last_update_time",
      "liked_count",
      "collected_count",
      "comment_count",
      "share_count",
      "image_list",
      "tag_list",
      "note_url",
      "source_keyword",
      "xsec_token"
    ],
    "data_types": "{'comment_id': 'object', 'create_time': 'float64', 'ip_location': 'object', 'note_id': 'object', 'content': 'object', 'user_id': 'object', 'nickname': 'object', 'avatar': 'object', 'sub_comment_count': 'object', 'pictures': 'object', 'parent_comment_id': 'float64', 'last_modify_ts': 'int64', 'like_count': 'object', 'type': 'object', 'title': 'object', 'desc': 'object', 'video_url': 'object', 'time': 'float64', 'last_update_time': 'float64', 'liked_count': 'object', 'collected_count': 'object', 'comment_count': 'object', 'share_count': 'object', 'image_list': 'object', 'tag_list': 'object', 'note_url': 'object', 'source_keyword': 'object', 'xsec_token': 'object'}",
    "missing_values": {
      "comment_id": 3250,
      "create_time": 3250,
      "ip_location": 5133,
      "note_id": 0,
      "content": 3250,
      "user_id": 0,
      "nickname": 0,
      "avatar": 0,
      "sub_comment_count": 3250,
      "pictures": 3250,
      "parent_comment_id": 3250,
      "last_modify_ts": 0,
      "like_count": 3250,
      "type": 27557,
      "title": 27557,
      "desc": 27557,
      "video_url": 27557,
      "time": 27557,
      "last_update_time": 27557,
      "liked_count": 27557,
      "collected_count": 27557,
      "comment_count": 27557,
      "share_count": 27557,
      "image_list": 27557,
      "tag_list": 27557,
      "note_url": 27557,
      "source_keyword": 27557,
      "xsec_token": 27557
    }
  },
  "cleaned_data": {
    "total_records": 20508,
    "columns": [
      "comment_id",
      "create_time",
      "ip_location",
      "note_id",
      "content",
      "user_id",
      "nickname",
      "avatar",
      "sub_comment_count",
      "pictures",
      "parent_comment_id",
      "last_modify_ts",
      "like_count",
      "type",
      "title",
      "desc",
      "video_url",
      "time",
      "last_update_time",
      "liked_count",
      "collected_count",
      "comment_count",
      "share_count",
      "image_list",
      "tag_list",
      "note_url",
      "source_keyword",
      "xsec_token",
      "content_clean",
      "content_length",
      "has_picture",
      "is_reply",
      "year",
      "quarter",
      "month",
      "day",
      "hour",
      "day_of_week",
      "day_name",
      "date",
      "datetime_str",
      "location_standard",
      "location_province",
      "location_city",
      "user_comment_count",
      "user_total_likes",
      "user_total_replies",
      "user_activity_score",
      "is_kol",
      "sentiment_score",
      "sentiment_label",
      "interaction_count",
      "has_interaction"
    ],
    "retention_rate": "66.57%",
    "records_removed": 10299
  },
  "cleaning_stats": {
    "records_removed": 10299,
    "new_features_added": [
      "is_kol",
      "sentiment_label",
      "user_comment_count",
      "day_name",
      "year",
      "sentiment_score",
      "location_city",
      "user_total_replies",
      "quarter",
      "user_total_likes",
      "content_length",
      "user_activity_score",
      "location_standard",
      "date",
      "hour",
      "day_of_week",
      "interaction_count",
      "content_clean",
      "month",
      "location_province",
      "has_picture",
      "day",
      "datetime_str",
      "is_reply",
      "has_interaction"
    ]
  },
  "data_quality_metrics": {
    "missing_content": 0,
    "avg_content_length": 31.761020089721086,
    "has_picture_ratio": 0.01838307002145504,
    "reply_ratio": 0.0,
    "avg_sentiment_score": 0.14211697487004682,
    "time_range": {
      "start": "2020-07-08 17:30:06",
      "end": "2025-12-19 09:54:24"
    },
    "location_distribution": {
      "中国": 15066,
      "其他地区": 4419,
      "美国": 620,
      "加拿大": 149,
      "澳大利亚": 94,
      "英国": 78,
      "日本": 73,
      "韩国": 9
    },
    "sentiment_distribution": {
      "中性": 14194,
      "正面": 4643,
      "负面": 1671
    },
    "kol_count": 2058
  },
  "technical_tools": "Python Pandas（数据清洗和特征工程）",
  "output_formats": [
    "CSV",
    "Parquet（适合Hadoop/Spark）",
    "JSON Lines"
  ]
}